% !TEX root = main.tex
\section{Analysis}

This chapter will describe how the BWIM system performs. What works? Why? How? etc.
The main focus should perhaps be placed on identifying the pros and cons of the matrix method and optimization method.

Should include:
\begin{itemize}
\item Compare theoretical and calculated influence lines. Also include influence lines found through Abaqus.
\item Check how influence lines found through matrix method and optimization reproduces the strain history
\item Test obtained influence line by running the bwim routine on the hitherto unused freight train. (Depends on getting info about the train). Also Do this test on the other trains.
\end{itemize}

\subsection{Strain data}
The following figure \ref{fig:strain_all}, contains raw strain data for 6 different trains passing the Lerelva bridge. Each subfigure contains data from three different strain sensors placed as described in System setup, see section:\ref{system_setup}. Three of the trains comes from the north side; train 3, train 5 and train 7, and three from the south side; train 4, 6 and 8. The strain signals all appear similar in form, except for train 7, figure\ref{fig:strain_train7}, which is a freight train. The other 5 trains are all of the same type, a NSB 92 type passenger train \ref{appendix:nsb92}.

The strain signals have different levels of peak height suggesting that the trains actual axle weights differ from what is found in table \ref{table:axle_weights}. This will throw off the magnitude of the resulting average influence line found through the matrix method. And this error in calculated influence line will inevitably be found again in the calculated axle weights \label{peaks_heights}.

To account for the different directions of the trains, the strain data for the trains going towards Trondheim has been reversed (correct word ?). This is not necessary for finding influence lines, but makes it easier placing the found influence lines in the same coordinate system.

Some of the signals were originally very long, due to not knowing exactly when the train would pass. This means cutting the signal into a vector containing the essential data. Ideally the goal was to identify exactly, or as closely as possible, the time the train entered the bridge. Due to noise and dynamic effects identifying this, proved a difficult process involving detection of peaks which lies close to peaks of noise. This proved possible to do for each individual signal, but a general method performing this for every signal was not within the authors capabilites. Therefore, to cut the signals as equally as possible the first and last major peaks of the signals were used as reference points for appending of samples before and after these peaks. For this method to prove exact, the speed of the train should be taken into consideration when appending sample points so that the influence lines of the signals gets an as equal length as possible.

The strain data from the freight train, figure \ref{fig:strain_train7}, is not used for finding the bridge's influence line because the train data is unknown. Axle weights for this train was not found, and guesswork of this data would be difficult. The locomotive data, and possibly the axle spacings of the train, would be the only data possible to find. Therefore this data will only be used for testing of influence lines.
\begin{figure}[H]
	\centering
	\begin{subfigure}[t]{0.4\textwidth}
		\centering
		\input{tikz/strains/raw_strain_train3.tex}
		\caption{Train 3, towards Heimdal}
		\label{fig:strain_train3}
	\end{subfigure}
	\qquad
	\begin{subfigure}[t]{0.4\textwidth}
		\centering
		\input{tikz/strains/raw_strain_train4.tex}
		\caption{Train 4, towards Trondheim}
		\label{fig:strain_train4}
	\end{subfigure}

	\begin{subfigure}[t]{0.4\textwidth}
		\centering
		\input{tikz/strains/raw_strain_train5.tex}
		\caption{Train 5, towards Heimdal}
		\label{fig:strain_train5}
	\end{subfigure}
	\qquad
  \begin{subfigure}[t]{0.4\textwidth}
    \centering
    \input{tikz/strains/raw_strain_train6.tex}
		\caption{Train 6, towards Trondheim}
    \label{fig:strain_train6}
  \end{subfigure}

  \begin{subfigure}[t]{0.4\textwidth}
    \centering
    \input{tikz/strains/raw_strain_train7.tex}
		\caption{Freight train, towards Heimdal}
    \label{fig:strain_train7}
  \end{subfigure}
    \qquad
	\begin{subfigure}[t]{0.4\textwidth}
		\centering
		\input{tikz/strains/raw_strain_train8.tex}
		\caption{Train 8, towards Trondheim}
		\label{fig:strain_train8}
	\end{subfigure}
  \caption{Strain data from Leirelva bridge}
  \label{fig:strain_all}
\end{figure}

\subsection{Optimized influence lines}
Perform the same procedures as for the matrix method

\subsection{Differences between the methods}
Compare the optimized influence lines and the matrix method influence lines. This should be done in a thorough manner.
\subsection{Problems}
\begin{itemize}
\item Big problem with identifying exactly when train enters and leaves the bridge. This results in guesswork when placing influence line in a coordinate system. Where does the bridge begin and end in the influence line.. The only definite certainty seems to be placing the index of the maximum magnitude of the influence line in the correct position according to the measuring sensor's location.
\item This could be problematic when using the found influence lines
\item These problems have been reduced, now the biggest problem is placing the peak of the influence line as well as possible. Possibly performing a smoothing and then finding position of peak could give a better estimate of sensorloc at influence line.. currently the max value of influence line is placed at sensorloc.
\end{itemize}


\subsection{The matrix method}
The matrix method creates an influence line for a specific strain history given a known train with known axle weights and velocity. Thus if the strain signal were recreated given with given parameters, the signal would be a almost exact replica of the measured strain signal, where the differences should originate from sensor noise. The found influence line would however be for this specific train and the passing's dynamic effects on the bridge, which is likely to vary from train to train. Therefore an averaging of a sufficient number of calculated influence lines should reduce or eliminate the dynamic effects from the influence line.

The analysis of the matrix method is based on 4 different train passings, and 3 sensor readings on each passing. The trains in these measurements is of the same type (not entirely shure!!) but the exact weight is not known. The weight of each axle were approximated by distributing carriage and locomotive gross weight. Passengers in the passing trains were not accounted for, and may lead to some deviation from ideal results.

To include effects from the train approach to the bridge, additional samples have been included from the strain signal before and after the first and last peak found in the signal. This will recreate the strain signal to a more complete degree (needs to be shown in a figure), but the found influence line usually displays more dynamic effects which is unwanted properties in a static influence line.

TODO:
\begin{itemize}
\item sout{Show the found influence lines for some sensors}
\item discuss the plots
\item reproduce strain signal, and compare with measured signal
\item sout{show averaged influence line}, and perform the same tests
\item show interpolation of this averaged influence line
\item perform the same test with this interpolated influence line
\item the alternative should also be done, interpolate each found influence line and average them, then reproduce the strain signal, and find difference through comparison.
\end{itemize}


\begin{figure}[H]
\centering
\begin{subfigure}[t]{0.4\textwidth}
	\centering
	\input{tikz/influenceLines/infl_vec3.tex}
	\caption{Influence line train 3}
	\label{fig:train3}
\end{subfigure}
\qquad
\begin{subfigure}[t]{0.4\textwidth}
	\centering
	\input{tikz/influenceLines/infl_vec4.tex}
	\caption{Influence line train 4}
	\label{fig:train4}
\end{subfigure}

\begin{subfigure}[t]{0.4\textwidth}
	\centering
	\input{tikz/influenceLines/infl_vec5.tex}
	\caption{Influence line train 5}
	\label{fig:train5}
\end{subfigure}
\qquad
\begin{subfigure}[t]{0.4\textwidth}
	\centering
	\input{tikz/influenceLines/infl_vec6.tex}
	\caption{Influence line train 6}
	\label{fig:train6}
\end{subfigure}

\begin{subfigure}[t]{0.9\textwidth}
	\centering
	\input{tikz/influenceLines/infl_vec8.tex}
	\caption{Influence line train 8}
	\label{fig:train8}
\end{subfigure}
\caption{Influence lines found through the matrix method, for the middle sensor}
\label{fig:Influence_lines}
\end{figure}



As plainly seen in figure \ref{fig:Influence_lines} there is big differences between the found influence lines. The trains are all of the same type meaning that the magnitudes of the influence lines, which should be the mostly dependent on axle weights, ought to be similar for all train passings. However as discussed in   When the plots are laid on top of each other, as in figure \ref{fig:infl_all_trains}, it is clearly visible that there is some variation in peak magnitude. The passings max magnitudes appears to be very similar for trains going in the same direction. The trains coming from Heimdal towards Trondheim appears to create influence lines of a slightly higher magnitude than for trains going in the oposite direction.
\subsubsection{Accuracy of the matrix method through recreating the strain signal}
One way of examining the accuracy of the matrix method is to recreate the strain signals by using the calculated influence lines. The following three subfigures show recreated signals for a single train passage, but for different sensor locations.
\begin{figure}[H]
\begin{subfigure}[t]{0.9\textwidth}
\centering
\input{tikz/strains/strain_recreated_train3_sensorTrondheim.tex}
% \caption{Recreated strain, Trondheim sensor with $Error = 3.868406648828302 \cdot 10^{-08}$}
\label{recreated_sensor_trond_train3}
\end{subfigure}

\begin{subfigure}[t]{0.9\textwidth}
\centering
\input{tikz/strains/strain_recreated_train3_sensorMiddle.tex}
% \caption{Recreated strain, middle sensor with $Error = 3.993607788778184e-08$}
\label{recreated_sensor_middle_train3}
\end{subfigure}

\begin{subfigure}[t]{0.9\textwidth}
\centering
\input{tikz/strains/strain_recreated_train3_sensorHeimdal.tex}
% \caption{Recreated strain, Heimdal sensor with $Error = 3.098732097445654e-08$}
\label{recreated_sensor_heimdal_train3}
\end{subfigure}

\caption{Recreated strain signals for train 3}
\label{fig:recreated_strains}
\end{figure}
Figure \ref{recreated_sensor_trond_train3} shows a strain signal from the sensor closest to Trondheim along with a signal recreated using the found influence line for that sensor. To identify and compare errors the following equation \ref{fig:recreated_strains}, performing least square error, will be used.
\begin{equation}
	Error = \sum{ (\varepsilon_{meas} - \varepsilon_{calc})^2}
\end{equation}
The recreated strain signals, see figure \ref{fig:recreated_strains}, illustrates the accuracy of the matrix method. However this way of using the found influence lines will.
\begin{table}
	\centering
	\begin{tabularx}{0.9\textwidth}{@{\extracolsep{\fill} } |X|X|X|X| }
		\hline
		\multicolumn{4}{ |c| }{Error table} \\ \hline
		 & Trondheim sensor & middle sensor & Heimdal sensor \\
		\hline
		train 3 & $Error = 3.8684 \cdot 10^{-8}$ & $Error = 3.9936 \cdot 10^{-8}$ & $Error = 3.0987 \cdot 10^{-8}$ \\
		\hline
		train 4 & $Error = 3.7437 \cdot 10^{-8}$ & $Error = 2.6794 \cdot 10^{-8}$ & $Error = 2.4965 \cdot 10^{-8}$ \\
		\hline
		train 5 & $Error = 4.5112 \cdot 10^{-7}$ & $Error = 2.3935 \cdot 10^{-7}$ & $Error = 1.9847 \cdot 10^{-7}$ \\
		\hline
		train 6 & $Error = 5.3555 \cdot 10^{-8}$ & $Error = 2.8783 \cdot 10^{-8}$ & $Error = 2.4336 \cdot 10^{-8}$ \\
		\hline
		train 8 & $Error = 3.6865 \cdot 10^{-8}$ & $Error = 2.3341 \cdot 10^{-8}$ & $Error = 2.6944 \cdot 10^{-8}$ \\
		\hline
		average & $Error = 1.2353 \cdot 10^{-7}$ & $Error = 7.1641 \cdot 10^{-8}$ & $Error  = 6.1141 \cdot 10^{-8}$ \\
		\hline
	\end{tabularx}
	\caption{Errors of the recreated strain signals found in \ref{fig:recreated_strains}, rounded to four decimals}
	\label{table:errors}
\end{table}
% \begin{table}
% 	\centering
% 	\begin{tabularx}{0.8\textwidth}{@{\extracolsep{\fill} } |X|X|X|X| }
% 		\hline
% 		\multicolumn{4}{ |c| }{Error table} \\ \hline
% 		 & Trondheim sensor & middle sensor & Heimdal sensor \\
% 		\hline
% 		train 3 & $Error = 3.868406648828302 \cdot 10^{-08}$ & $Error = 3.993607788778184 \cdot 10^{-08}$ & $Error = 3.098732097445654 \cdot 10^{-08}$ \\
% 		\hline
% 		train 4 & $Error = 3.743691709710994 \cdot 10^{-08}$ & $Error = 2.679397157480041 \cdot 10^{-08}$ & $Error = 2.496512758686899 \cdot 10^{-08}$ \\
% 		\hline
% 		train 5 & $Error = 4.511191205188476 \cdot 10^{-07}$ & $Error = 2.393487728341214 \cdot 10^{-07}$ & $Error = 1.984737477913679 \cdot 10^{-07}$ \\
% 		\hline
% 		train 6 & $Error = 5.355538148342079 \cdot 10^{-08}$ & $Error = 2.878349901359182 \cdot 10^{-08}$ & $Error = 2.433609830772061 \cdot 10^{-08}$ \\
% 		\hline
% 		train 8 & $Error = 3.686538817599529 \cdot 10^{-08}$ & $Error = 2.334140280826060 \cdot 10^{-08}$ & $Error = 2.694448199907672 \cdot 10^{-08}$ \\
% 		\hline
% 		average & $Error = 1.2353 \cdot 10^{-07}$ 					 & $Error = 7.1641 \cdot 10^{-08}$ 						& $Error  = 6.1141 \cdot 10^{-08}$ 					 \\
% 		\hline
% 	\end{tabularx}
% 	\caption{Errors of the recreated strain signals found in \ref{fig:recreated_strains}}
% 	\label{table:errors}
% \end{table}

Train 5 is clearly distinctive, in regards of how it oscillates in plot \ref{fig:train5} and how it recreates the strain with error as in table \ref{table:errors}. There are several possible causes for these deviating results, among them wrongly determined velocity of the train and that the trains speed amplifies dynamic effects in the bridge and sensor.

Error table for 600 samples before and after, for smoothed and unsmoothed signal. Also excluding train 5 which is found to show large dynamic effects. Filtering removes frequencies above 10 Hz.
\begin{table}
	\centering
	\begin{tabularx}{0.9\textwidth}{@{\extracolsep{\fill} } |X|X|X|X| }
		\hline
		\multicolumn{4}{ |c| }{Error table, filtered signals} \\ \hline
		 & Trondheim sensor & middle sensor & Heimdal sensor \\
		\hline
		train 3 & $Error = 9.0579 \cdot 10^{-8}$ & $Error = 8.8553 \cdot 10^{-8}$ & $Error = 8.2682 \cdot 10^{-8}$ \\
		\hline
		train 4 & $Error = 5.8366 \cdot 10^{-8}$ & $Error = 9.8604 \cdot 10^{-8}$ & $Error = 6.0953 \cdot 10^{-8}$ \\
		\hline
		train 6 & $Error = 4.9018 \cdot 10^{-8}$ & $Error = 9.2035 \cdot 10^{-8}$ & $Error = 4.5365 \cdot 10^{-8}$ \\
		\hline
		train 8 & $Error = 5.4430 \cdot 10^{-8}$ & $Error = 9.5485 \cdot 10^{-8}$ & $Error = 6.5290 \cdot 10^{-8}$ \\
		\hline
		average & $Error = 6.3098 \cdot 10^{-8}$ & $Error = 9.3669 \cdot 10^{-8}$ & $Error  = 6.357 \cdot 10^{-8}8$ \\
		\hline
	\end{tabularx}
	\caption{Errors of the recreated strain signals with original signal filtered for noise, rounded to four decimals}
	\label{table:errors_filtered}
\end{table}

% \begin{table}
	% \centering

\begin{minipage}{\linewidth}
	\centering
	\captionof{table}{Error table w/o filtering} \label{table:errors_unfiltered}
	\begin{tabularx}{0.9\textwidth}{@{\extracolsep{\fill} } |X|X|X|X| }
		\hline
		\multicolumn{4}{ |c| }{Error table, w/o filtering} \\ \hline
		 & Trondheim sensor & middle sensor & Heimdal sensor \\
		\hline
		train 3 & $Error = 5.9214 \cdot 10^{-8}$ & $Error = 6.3572 \cdot 10^{-8}$ & $Error = 3.9315 \cdot 10^{-8}$ \\
		\hline
		train 4 & $Error = 3.3116 \cdot 10^{-8}$ & $Error = 7.1066 \cdot 10^{-8}$ & $Error = 3.1627 \cdot 10^{-8}$ \\
		\hline
		train 6 & $Error = 3.3947 \cdot 10^{-8}$ & $Error = 6.9690 \cdot 10^{-8}$ & $Error = 2.9709 \cdot 10^{-8}$ \\
		\hline
		train 8 & $Error = 2.8439 \cdot 10^{-8}$ & $Error = 6.6137 \cdot 10^{-8}$ & $Error = 3.6453 \cdot 10^{-8}$ \\
		\hline
		average & $Error = 3.8679 \cdot 10^{-8}$ & $Error = 6.7616 \cdot 10^{-8}$ & $Error = 3.4276 \cdot 10^{-8}$ \\
		\hline
	\end{tabularx}
	Should be a caption
\end{minipage}
	% \caption{Errors of the recreated strain signals without filtering, rounded to four decimals}
	% \label{table:errors_unfiltered}
% \end{table}

The differences between the unfiltered and filtered errors, tables \ref{table:errors_filtered} and \ref{table:errors_unfiltered} respectively, are clear but not unexpected. They show that the filtering does not distort the error to an amount which destroys the accuracy of the influence line. To really compare the methods of filtering however the found influence lines should be used to calculate axle weights. Averaging of the influence lines gives the following plots.

% \begin{figure}[H]
	% \centering
	\begin{figure}[H]
		\centering
		\input{tikz/influenceLines/infl_vec_averaged_filteredAfter_midSensor_wBridge.tex}
		\caption{Influence line, filtered after averaging}
		\label{fig:infl_avg_filtered_after}
	\end{figure}
	% \qquad
	\begin{figure}[H]
		\centering
		\input{tikz/influenceLines/infl_vec_averaged_filtered_before_midSensor_wBridge.tex}
		\caption{Influence line, filtered strain signals}
		\label{fig:infl_avg_filtered_before}
	\end{figure}

% \end{figure}


% (5.9214e-008 + 3.3116e-008 + 3.3947e-008 + 2.8439e-008) / 4
% (6.3572e-008 +  7.1066e-008 +  6.9690e-008 +  6.6137e-008) / 4
% (3.9315e-008 +  3.1627e-008 +  2.9709e-008 +  3.6453e-008)/4
% (9.0579e-008 + 5.8366e-008 + 4.9018e-008 + 5.4430e-008)/4
% (8.8553e-008 + 9.8604e-008 + 9.2035e-008 + 9.5485e-008)/4
% (8.2682e-008 + 6.0953e-008 + 4.5365e-008 + 6.5290e-008)/4

\subsubsection{Dynamic effects}
The dynamic effects can clearly be seen in the plots for the various train passings. They appear as oscillations in the plots, and are more visible in the low magnitude areas of the influence line. These oscillations vary from train to train making it clear that the dynamic effects depends on the train. The varying influencing factors may be train speed and weight. In the source code producing these influence lines an assumption of train weight has been made, which makes all train axles equal in weight.
What is interesting is the effects of an approaching train, which clearly induces oscillations in the bridge even though the train is as far as 40 meters away from the beginning of the bridge. The differences between the dynamic effects for the train passings may relate to velocity, axle weights and train acceleration (there may be more causes).

These dynamic effects are unwanted in the static influence line. In theory, averaging enough influence lines should reduce these effects enough to get usable data. This thesis does not contain enough train passings to achieve this. Also as mentioned before, one of the trains have amplified dynamic effects which throw off the results somewhat when performing averaging. Therefore exluding the results from train 5 as in would be reasonable. Figure \ref{fig:infl_vec_averaged_wo_train5} shows the average of the different influence lines where train 5 has been excluded. This plot still contain dynamic effects, which will need to be removed, but the amplitude of the oscillations have been visibly reduced.
Shortening the number of samples in the case without train 5, reduces the dynamic effects furter, and a filtering of higher frequencies gives amore usable influence line as seen in \ref{fig:infl_vec_averaged_fft10hz}.
A general formula for identifying influence lines with too much oscillation should be developed. One way could be to use table \ref{table:errors} and exlude the trains which dominates error, or that differs most from the other trains.

The support towards Trondheim is of a special nature, it is connected to a very little bridge spanning perhaps 2 meters which cars may pass under. This may affect the trains entry and cause dynamic effects. It also provides a problem when deciding what should be part of the final influence line, what influences the sensor?
One way to do it would be to simply cut the influence line at the samples corresponding to the bridge, however that does not seem likely to be a very good solution. Another way would be to smooth the influence line to the point where the entry part becomes itegrated with the the major influence line peak.

\begin{figure}[H]
	\centering
	\input{tikz/influenceLines/infl_vec_all.tex}
	\caption{Influence lines from figure:\ref{fig:Influence_lines} on top of each other}
	\label{fig:infl_all_trains}
\end{figure}

\begin{figure}[H]
	\centering
	\input{tikz/influenceLines/infl_averaged_wBridge.tex}
	\caption{Averaged of the 5 trains}
	\label{fig:infl_vec_averaged_wBridge}
\end{figure}

\begin{figure}[H]
	\centering
	\input{tikz/influenceLines/infl_vec_averaged_woTrain5_midSensor_wBridge.tex}
	\caption{Averaged influence line without train 5}
	\label{fig:infl_vec_averaged_wo_train5}
\end{figure}

\begin{figure}[H]
	\centering
	\input{tikz/influenceLines/infl_vec_averaged_fft10hz.tex}
	\caption{Shorter averaged influence line for the middle sensor without train 5}
	\label{fig:infl_vec_averaged_fft10hz}
\end{figure}

A possible way to place the found influence line is shown in figure \ref{fig:infl_vec_averaged_wBridge}, which places the influence line in the assumed position on the bridge. The maximum magnitude of the influence line should be found at the sensor location, thusly the averege influence line has been placed in the corrdinate system of the bridge accordingly. There is however the problem of noise, which makes identifying the actual max peak difficult.

Filtering the signals so that a singular smooth maximum peak can be identified. This could distort the actual signal, but will be an interesting approach.

This placement of the first peak and it's influence line also decides the follwoing placement of the influence line which are decided by the axle spacings found by the BWIM system. Therefore a wrongly placed first axle would provide increasing error for each axle found.
Alternatively each influence line could be placed according to the identified axles or bogies. Since the axle distances is known for the signals in this thesis identifying the first axle or bogie and placing the rest
\subsubsection{Influence lines from filtered strain}

\subsubsection{Influence lines from unfiltered strain}



\subsubsection{Calculate the axle weights}
The axle weights used to calculate the influence lines are as in table \ref{table:axle_weights}. These are as discussed in chapter method something!!. The system setup described in section \ref{system_setup}, gives us three different locaions for measuring strain and so we have three diffferent influence lines generated by the BWIM program. When calculating the axle weights corresponding to each train, we will then have three different estimates of the axle weights.

\begin{figure}[h]
	\begin{subfigure}[t]{0.3\textwidth}
		\input{tikz/influenceLines/averagedInfluenceline_sensor1.tex}
		\caption{sensor 1}
		\label{fig:sensor1}
	\end{subfigure}
	\begin{subfigure}[t]{0.3\textwidth}
		\input{tikz/influenceLines/averagedInfluenceline_sensor2.tex}
		\caption{sensor 1}
		\label{fig:sensor1}
	\end{subfigure}
	\begin{subfigure}[t]{0.3\textwidth}
		\input{tikz/influenceLines/averagedInfluenceline_sensor3.tex}
		\caption{sensor 1}
		\label{fig:sensor1}
	\end{subfigure}
	\caption{averaged filtered influence lines used to calculate axle weights}
	\label{averaged_filtered_infl_lines}
\end{figure}


\begin{table}[h]
	\centering
	\begin{tabularx}{\textwidth}{ |X|X|X|X|X|X|X|X|X| }
		\hline
		Axle & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 \\
		\hline
		Axle weight [\SI{}{\kg}] & 9500 &	9500 & 9500 &	9500 & 14575 & 14575 & 14575 & 14575 \\
		\hline
	\end{tabularx}
	\caption{Table of axle weights used to perform BWIM}
	\label{table:axle_weights}
\end{table}

\begin{table}[h]
	\centering
	\begin{tabularx}{\textwidth}{@{\extracolsep{\fill} } |X|X|X|X|X|X|X|X|X| }
		\hline
		Axle & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 \\
		\hline
		Train 3: axle weight [\SI{}{\kg}] & 12961 &	2650 & 12627 &	3185 & 19950 & 4529 & 18450 & 4474 \\
		\hline
		Train 4: axle weight [\SI{}{\kg}] & 11772 &	8569 & 1112 &	8404 & 16646 & 13129 & 15673 & 11894 \\
		\hline
		Train 6: axle weight [\SI{}{\kg}] & 12861 &	7306 & 12663 &	7717 & 18694 & 11667 & 17822 & 9619 \\
		\hline
		Train 8: axle weight [\SI{}{\kg}] &  12172 &	8042 & 11774 &	8271 & 17076 & 13411 & 16356 & 11823 \\
		\hline
	\end{tabularx}
\end{table}

\begin{table}[h]
	\centering
	\begin{tabularx}{\textwidth}{@{\extracolsep{\fill} } |X|X|X|X|X|X|X|X|X|X|X|X|X| }
		\hline
		 & \multicolumn{3}{ |c| }{Train 3} & \multicolumn{3}{ |c| }{Train 4} & \multicolumn{3}{ |c| }{Train 6} & \multicolumn{3}{ |c| }{Train 8}\\
		\hline
		Axle\textbackslash sensor & 1 & 2 & 3 & 1 & 2 & 3 & 1 & 2 & 3 &  1 & 2 & 3 \\
		\hline
		1 [\SI{}{\kg}] & 8295 & 5875 & 6654 & 10543 & 7839 & 7212 & 10783 & 8004 &  6933 & 10336 & 7831 & 6869 \\
		\hline
		2 [\SI{}{\kg}] & 9243 & 6849 & 5614 & 10132 & 7413 & 5727 & 10206 & 7095 & 6691 & 10276 & 7323 & 6128 \\
		\hline
		3 [\SI{}{\kg}] & 8492 & 6579 & 6947 & 9897 & 8076 & 6810 & 10849 & 8631 & 6731 & 9808 & 8122 & 6452 \\
		\hline
		4 [\SI{}{\kg}] & 8715 & 6543 & 4546 & 9714 & 6740 & 4984 & 10432 & 7100 & 6136 & 10300 & 7182 & 5729 \\
		\hline
		car sum [\SI{}{\kg}] & 34745 & 25846 & 23761 & 40286 & 30068 & 24733 & 42270 & 30830 & 26491 & 40720 & 30458 & 25178 \\
		\hline
		5 [\SI{}{\kg}] & 13072 & 10066 & 10160 & 14897 & 12600 & 10002 & 15304 & 12323 & 9913 & 14015 & 11726 & 9192 \\
		\hline
		6 [\SI{}{\kg}] & 14405 & 11204 & 9846 & 15188 & 11800 & 9948 & 15921 & 11582 & 11275 & 16679 & 12526 & 11617 \\
		\hline
		7 [\SI{}{\kg}] & 10936 & 8733 & 9729 & 13860 & 11751 & 10319 & 15118 & 12554 &10376 & 13356 & 11569 & 9490 \\
		\hline
		8 [\SI{}{\kg}] & 14073 & 10897 & 8877 & 13801 & 10476 & 8624 & 13608 & 9730 & 9401 & 14910 & 11179 & 9878 \\
		\hline
		Loc sum [\SI{}{\kg}] & 52486  & 40900 & 38612 & 57746 & 46627 & 38893 & 59951 & 46189 & 40965 & 58960 & 47000 & 40177 \\
		\hline
		tot sum [\SI{}{\kg}] & 87231 & 66746 & 62374 & 98031 & 76695 & 63625 & 102221 & 77019 & 67457 & 99680 & 77457 & 65355 \\
		\hline
	\end{tabularx}
\end{table}

As table \ref{table:axleWeights_elongated} shows, there clearly is some error in the calculated axle weights. Especially sensor 2 and 3 which generally gives very low estimates. This trend hold for minimal and extended influence lines as well.
1.0e+04 *
train 3 - sensor 1
   1.271778172542739 = 12718
   0.378926430506878 = 3789
   1.242305356101132 = 12423
   0.399028466245941 = 3990
   1.948355437841644 = 19484
   0.621391415532922 = 6214
   1.773439643607879 = 17734
   0.608923137975413 = 6089
	 sum = 8.244148060354548e+04

train 4 - sensor 1
10422
10258
 9786
 9822
14729
15360
13690
13967

train 6 - sensor 1
12287
8187
12379
8538
17602
12990
17251
10681
sum =  99914

train 8 - sensor 1
11145
 9426
10599
 9529
15248
15467
14576
13704
sum = 99695

train 3 - sensor 2
3835
8497
4474
8346
7209
13586
5743
13242
sum = 64932

train 4 - sensor 2
-29
12134
-129
11880
1701
18345
-583
18020
sum =  61339

train 6 - sensor 2
